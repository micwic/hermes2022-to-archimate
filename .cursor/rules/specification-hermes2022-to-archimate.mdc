---
description: Sp√©cification g√©n√©rale du projet hermes2022-to-archimate
alwaysApply: true
---

# hermes2022-to-archimate/.cursor/rules/specification-hermes2022-to-archimate.mdc: Sp√©cification g√©n√©rale du projet hermes2022-to-archimate

> Cr√©√© le : 2025-08-15  
> Derni√®re mise √† jour : 2025-10-20

## Description g√©n√©rale

- Le projet hermes2022-to-archimate vise √† cr√©er une brique logicielle qui participe √† l'objectif de constituer un r√©f√©rentiel d'architecture d'entreprise unique qui comprend √† la fois les m√©thodologies de projet - en l'occurrence HERMES2022 √©dict√©e par la Conf√©d√©ration Helv√©tique - et les √©l√©ments d'architecture d'entreprise (selon les couches du framework Archimate 3.2 : Strat√©gie, M√©tier, Application, Technologie, Impl√©mentation & Migration et Migration et l'analyse transverse Motivation) impact√©s par les projets de transformation digitale.

- La brique logicielle est appel√©e √† traduire les concepts HERMES2022 en √©l√©ments et relations standards de r√©f√©rence conformes √† Archimate de mani√®re √† permettre de les d√©cliner ensuite dans des √©l√©ments sp√©cialis√©s sous-jacents sp√©cifiques aux projets respectifs dans lesquels la m√©thode est appliqu√©e. Ces derniers √©tant li√©s aux √©l√©ments standards par une relation de Sp√©cialisation pour assurer le lien avec les standards de la m√©thodologie.

  | Concept HERMES2022    | Traduction en Archimate 3.2 |
  |-----------------------|-----------------------------|
  | Sc√©narios            | Fonctions m√©tier qui regroupe des modules |
  | Modules              | Fonctions m√©tier qui regroupe des processus m√©tier |
  | Phases               | Processus m√©tier qui regroupe des t√¢ches |
  | T√¢ches               | Processus (√©l√©mentaire) m√©tier qui implique (assignation selon raci) des r√¥les et qui produit (trigger √©v√©nements, lecture/√©criture donn√©es m√©tier) des r√©sultats |
  | R√¥les                | R√¥les m√©tier assign√© √† une t√¢che ou associ√© une collaboration m√©tier (repr√©sentant un comit√©) |
  | R√©sultats (jalons)   | Ev√©nements m√©tier |
  | R√©sultats (artefacts)| Donn√©es m√©tier -> Artefacts |

- Le concept est appel√© √† servir de rep√®re m√©thodologique de mani√®re totalement int√©gr√© au r√©f√©rentiel d'entreprise qui comprend d√®s lors la d√©marche standard de r√©f√©rence et la d√©marche effectivement appliqu√©e aussi bien que les √©l√©ments impact√©s par la d√©marche de projet de transformation digitale constituant une source unique de v√©rit√© (selon d'autres normes standards √©galement) √† m√™me d'alimenter des fonctionnalit√©s Retrieval Augmented Generation destin√©es √† des mod√®les de langage large (LLM) par exemple avec le projet cii-via-cip-archimate-ia-repository. Le concept est √©tendu en cours d'ex√©cution du projet apr√®s avoir √©t√© aliment√© avec la m√©thodologie standard d'une part avec les √©l√©ments sp√©cifiques mis en oeuvre dans la d√©marche projet dans le contexte et √©galement d'autre part avec les √©ventuelles applications qui supportent les t√¢ches (relation de service), voire produisent des artefacts (donn√©es applicatives interm√©diaires entre artefacts et donn√©es m√©tier).

  | Couche | Description                                      | √âl√©ments Cl√©s                                                                 |
  |--------|--------------------------------------------------|-------------------------------------------------------------------------------|
  | 1      | M√©thodologie standard (R√©f√©rence/Rep√®re m√©thodologique) | - El√©ments (Processus m√©tier, donn√©es m√©tier, artefacts (mod√®les de document), r√¥les, collaborations m√©tier (instances)                                     |
  | 2      | D√©marche appliqu√©e au projet                     | - Extensions ajout√©es en cours d'ex√©cution avec des √©l√©ments de m√™mes type que ceux de la m√©thodologie standard effectivement mis en oeuvre, reli√©s au standard avec une relation de sp√©cialisation                                             |
  | 3      | Extensions potentielles (Moyens au service du projet)                          | - Applications mises en ≈ìuvre (gestion, bureautique, mod√©lisation, dev, ...)<br>- Artefacts produits dans le cadre de la d√©marche de projet<br>- Localisation/Emplacement des artefacts (node, device)                              |
  | 4      | √âl√©ments de l'architecture impact√©s                                | - Infrastructure (Sites)<br>- Syst√®mes & R√©seaux<br>- Applications & Donn√©es m√©tier<br>- Organisation et Cha√Æne de valeur M√©tier<br>- Motivation & strat√©gie |

- La finalit√© des diff√©rents projets men√©s dans le cadre de cette initiative personnelle est de faire la d√©monstration de la pertinence de combiner Archimate avec l'intelligence artificielle pour en faire un r√©f√©rentiel source unique de v√©rit√© b√¢ti selon des m√©tamod√®les standards qui peut se d√©cliner sur l'entier du cycle de vie d'un produit logiciel de l'√©laboration de la vision m√©tier jusqu'√† la documentation technique de r√©f√©rence de bas niveau et qui soit interpr√©table par l'IA de mani√®re s√ªre et fiable pour produire des artefacts sous diverses autres formes √† but et destination d'audiences sp√©cifiques (audit par exemple, conformit√© √† des standards, ...).

## Contexte

- HERMES2022 est la m√©thodologie standard de gestion de programme et de projet de la conf√©d√©ration helv√©tique (<https://www.hermes.admin.ch/fr/>)
- Archimate est une norme de repr√©sentation d'architecture d'entreprise √©dict√©e par l'Open Group, la version actuelle est la version 3.2 (<https://pubs.opengroup.org/architecture/archimate3-doc>)
- Archi est un outil de gestion et de mod√©lisation d'un r√©f√©rentiel d'architecture d'entreprise selon la norme Archimate (<https://www.archimatetool.com>), il comprend un plugin JArchi qui permet de manipuler programmatiquement les mod√®les ainsi que les √©l√©ments, les relations et les vues d'un mod√®le.
- Cursor est un outil de d√©veloppement centr√© sur l'usage de l'IA.
- NuExtract (3.8B, bas√© sur Phi-3-mini) est un llm open source con√ßu express√©ment pour extraire des donn√©es structur√©es depuis du texte ou HTML vers JSON (<https://www.numind.ai>). D√©velopp√© par NuMind, le mod√®le garantit un JSON valide syst√©matiquement et excelle dans le respect des sch√©mas.
- Ollama est un outil open source pour servir des mod√®les de langage locaux de mani√®re simple et efficace (<https://www.ollama.com>), permettant le d√©ploiement et l'ex√©cution de LLM comme NuExtract directement sur du hardware personnel (ex. RTX 1000 Ada). Il fournit une API compatible OpenAI pour une int√©gration ais√©e avec des applications TypeScript, facilitant l'extraction structur√©e HTML‚ÜíJSON en environnement souverain et hors ligne, tout en optimisant l'utilisation des ressources GPU.
- Javascript/Typescript sont les langages de scripting privil√©gi√©s dans le cadre du projet.
- Le cycle de d√©veloppement logiciel privili√©gie Behavior-driven Development, avec Gherkin et les framerwork cucumber et Jest (voir @bdd-governance.mdc)
- Neo4j est une base de donn√©es graphe avec des fonctionnalit√©s additionnelles RAG et Vector utilis√©es pour alimenter l'IA avec des composants client-serveur MCP selon les principes RAG int√©gr√©es au chat Cursor. Une base documentaire vectoris√©e est cr√©√©e dans neo4j √† partir des mod√®les Archimate export√© de Archi pour alimenter l'IA dans le cadre du projet cii-via-cip-archimate-ia-repository.
- Customer Information Interface via Customer Information Port est un projet personnel d'√©tude d'opportunit√© men√© selon HERMES2022 et Archimate et donnant lieu √† l'√©laboration d'une preuve de concept complexe n√©cessitant plusieurs projets de d√©veloppements sp√©cifiques (React, Spring, Flowable, UIPath, Kexcloack, OsixiaLDAP, OAuth2, ...) dans un contexte s√©curis√© d'entreprise qui v√©rifie la faisabilit√© technique et fournit des indicateurs cl√©s pour mesurer l'effort n√©cessaire d'une r√©alisation √† l'√©chelle.

## Objectifs

- Acqu√©rir √† partir d'internet, faire traduire et mettre √† jour de mani√®re efficiente et s√ªre les concepts de la m√©thode HERMES2022 en √©l√©ments et relations selon Archimate √† l'aide de l'IA (mod√®le LLM sp√©cialis√© NuExtract) dans un r√©f√©rentiel d'architecture d'entprise selon Archimate g√©r√© avec Archi. Ces √©l√©ments et relations de r√©f√©rence √† la m√©thodologie standard peuvent ainsi √™tre utilis√©s dans le cadre des projets avec des √©l√©ments sp√©cialis√©s de m√™me type selon l'application de la m√©thode dans les contexte des projects planifi√©s et ex√©cut√©s.

- Alimenter un pipeline RAG √† base MCP avec ces m√™mes informations de r√©f√©rence de la m√©thodolgie standard charg√©es dans Neo4j aux c√¥t√©s des √©l√©ments du r√©f√©rentiel d'architecture d'entpreprise. Le mod√®le IA g√©n√©raliste utilis√© pour g√©n√©rer des r√©ponses √† partir du r√©f√©rentiel d'architecture d'entreprise peut ainsi √™tre aliment√© en information s√ªre et fiable sur la m√©thodologie standard appliqu√©e m√™me si il n'a pas √©t√© entra√Æn√© sur le sujet.

- Proposer une alternative √† l'architecture ETL d'import/export √† partir du format d'interchange standard d√©fini par l'Open Group utilis√©e dans le cadre du projet cii-via-cip-archimate-ia-repository en utilisant plut√¥t l'interface du plugin JArchi de Archi pour manipuler le r√©f√©rentiel d'architecture d'entreprise sous Archi de mani√®re interactive.

## Conception g√©n√©rale

- Le projet est divis√© en deux modules distincts :
  - **Script Javascript JArchi**
    - 1a) Extraction/Transformation des concepts HERMES2022 √† partir du site internet
    - 1b) Chargement/Mise √† jour des √©l√©ments et relations correspondant aux concepts HERMES2022 dans un mod√®le Archimate de Archi
  - **Javascript**
    - 2) Chargement/Mise √† jour des noeuds d'une base de donn√©es graphe Neo4j correspondant aux concepts standards HERMES2022.

- L'Extraction/Transformation donne lieu √† la cr√©ation/mise √† jour de fichiers interm√©diaires structur√©s et v√©rifiables pour √™tre partag√©s comme donn√©es de r√©f√©rence en entr√©e par les autres modules 1) pour le chargement initial et la mise √† jour de mod√®les Archimate Archi 2) et pour le chargement des concepts HERMES2022 dans la base de donn√©es graphe Neo4j.

- Les fichiers interm√©diaires sont structur√©s selon un standard reconnu, lisibles et v√©rifiables tant par l'humain que par la machine (process flow with humanin the loop).

## Structure de r√©pertoire

| √âl√©ment | Type | Description |
|:--------|:-----|:------------|
| `/hermes2022-concepts-site-extraction/` | R√©pertoire | Module d'extraction des concepts HERMES2022 √† partir du site internet |
| `/archimate-model-loader/` | R√©pertoire | Chargement initial ou mis √† jour dans un mod√®le Archimate des √©l√©ments et relations correspondant aux concepts HERMES2022 |
| `/hermes2022-ia-loader` | R√©pertoire | Chargement des concepts HERMES2022 dans Neo4j |
| `/shared/` | R√©pertoire | Structure, types, validations et donn√©es partag√©es entre les modules |
| `/__tests__/` | R√©pertoire | Tests de conformit√© √† la pr√©sente sp√©cification |
| `README.md` | Documentation | [Lien sur la documentation selon les r√®gles de gouvernance g√©n√©rale] |

## D√©cisions architecturales et techniques

### Approche hybride IA & scripting

#### Description d√©taill√©e de la d√©cision

2025-08-16 Plusieurs approches ont √©t√© envisag√©es pour extraire les concepts HERMES2022 du site internet de la Conf√©d√©ration Helv√©tique (<https://www.hermes.admin.ch/en/>).
L'analyse des contenus du site en question a permis d'identifier des pages sp√©cifiques parfaitement organis√©es qui contiennent les informations n√©cessaires. Elles peuvent √™tre interpr√©t√©es efficacement et s√ªrement par l'IA avec des prompts appropri√©s pour produire des listes interm√©diaires structur√©es sur lesquelles se reposer pour alimenter et mettre √† jour un r√©f√©rentiel Archimate. Lesdites listes interm√©diaires peuvent par ailleurs √™tre administr√©es manuellement le cas √©ch√©ant pour proc√©der √† des ajustements et/ou √† des corrections.

Le projet est ainsi divis√© en deux parties qui se d√©roulent s√©quentiellement et trois modules :

**Phase 1 - Extraction :**

- `hermes2022-concepts-site-extraction` : Extraction automatis√©e des concepts HERMES2022 depuis le site web avec assistance IA, production de fichiers JSON interm√©diaires valid√©s

**Phase 2 - Chargement parall√®le :**

- `archimate-model-loader` : Chargement des concepts dans un mod√®le ArchiMate via l'interface JArchi d'Archi
- `hermes2022-ia-loader` : Chargement des concepts dans Neo4j pour services RAG et int√©gration IA

**Architecture modulaire :**

- Modules ind√©pendants communiquant via fichiers JSON interm√©diaires
- Interface standardis√©e JSON Schema pour validation des donn√©es
- Ex√©cution s√©quentielle Phase 1 puis Phase 2, modules Phase 2 ex√©cutables en parall√®le

#### Justification de la d√©cision

- Utilisation et mise en valeur du potentiel de l'IA dans un contexte parfaitement appropri√©
- Solution s√ªre avec revue et validation possible des listes interm√©diaires produites
- Gain de temps et d'effort substantiel

#### Patterns valid√©s √† suivre suite √† la d√©cision

- **S√©paration extraction/chargement** : Modules ind√©pendants avec interfaces d√©finies
- **Validation humaine** : Processus de revue des listes interm√©diaires
- **IA assist√©e** : Prompts structur√©s pour extraction coh√©rente

#### Anti-Patterns en raison d'erreurs identifi√©es, √† ne pas reproduire

- **Extraction directe** : √âviter l'extraction directe sans validation ‚Üí **Solution** : Listes interm√©diaires validables ‚Üí **R√®gle √† adopter** : Processus de validation syst√©matique

#### √âtat d'impl√©mentation de la d√©cision

üöß [En cours de conception et r√©alisation]

### Structure et format du fichier interm√©diaire

#### Description d√©taill√©e pour Structure et format du fichier interm√©diaire

- Le fichier interm√©diaire est en format JSON
- La structure est d√©finie et les donn√©es sont typ√©es sont un sch√©ma json (jsonschema)
- Les d√©finitions du sch√©ma json sont g√©r√©es dans plusieurs fichiers repr√©sentant les diff√©rentes parties du fichier (#ref, #ref) pour faciliter la maintenance
- Un fichier de donn√©es unique est cr√©√© afin de faciliter l'interpr√©tation et le chargement de celui-ci dans la base de donn√©es graphe Neo4j pour alimenter l'IA par RAG

#### Justification pour Structure et format du fichier interm√©diaire

- Format JSON : Lisibilit√© humaine et machine
- JSON Schema : Validation structurelle automatis√©e
- Modularit√© : Maintenance facilit√©e par la s√©paration des sch√©mas
- Interop√©rabilit√© : Format universel pour les 3 modules

#### Patterns valid√©s pour Structure et format du fichier interm√©diaire

- **JSON Schema modulaire** : S√©paration par domaines fonctionnels
- **Validation syst√©matique** : Contr√¥les automatis√©s avant consommation
- **Documentation int√©gr√©e** : Sch√©mas auto-document√©s

#### Anti-Patterns pour Structure et format du fichier interm√©diaire √† √©viter

- **Sch√©ma monolithique** : √âviter un seul fichier schema complexe ‚Üí **Solution** : Modularit√© par r√©f√©rences ‚Üí **R√®gle √† adopter** : Un sch√©ma par domaine ou concept pour faciliter la maintenance

#### √âtat d'impl√©mentation pour Structure et format du fichier interm√©diaire

üöß [En cours de conception et r√©alisation]

### Cadre de tests BDD et validation JSON ‚Äî frameworks, versions, usages

#### Description d√©taill√©e pour Cadre de tests BDD et validation JSON

- Frameworks et versions actuellement utilis√©s au stade tests:
  - Jest: 30.0.5
  - jest-cucumber: 4.5.0
  - ts-jest: 29.4.1
  - babel-jest: 30.0.5
  - Ajv: 8.17.1
  - ajv-formats: 3.0.1
- Port√©e: ex√©cution des sc√©narios BDD (Gherkin) et validation des artefacts
  JSON interm√©diaires via JSON Schema.
- Contexte Node.js: √† documenter (version exacte de l‚Äôenvironnement d‚Äôex√©cution).

#### Crit√®res de choix des versions

- Compatibilit√© Node LTS (‚â•18; recommand√©: 20).
- Alignement inter-packages (m√™mes majors, int√©grations √©prouv√©es).
- Stabilit√©/maintenance et correctifs r√©cents.
- Simplicit√© d‚Äôex√©cution des steps TypeScript sans build.

#### Justification des version par composant

##### Jest 30.0.5**

- Version majeure actuelle, maintenance active, corrections/performances r√©centes.
- Aligne babel-jest sur la m√™me major 30.
- Compatible Node 18/20; pas de besoin d‚Äô√©cosyst√®me Cucumber s√©par√©.

##### jest-cucumber 4.5.0

- Couche BDD Gherkin fine au‚Äëdessus de Jest; d√©coupl√©e du moteur TS.
- Version r√©cente stable, compatible Jest 29/30.

##### ts-jest 29.4.1

- Permet d‚Äôex√©cuter directement des steps .ts sans transpilation pr√©alable.
- Choix pragmatique tant que la compatibilit√© avec Jest 30 est satisfaisante dans ce repo. Si contrainte, on bascule soit:
√† Jest 29.x (compat matrice officielle avec ts-jest 29.x), soit
√† une cha√Æne Babel‚Äëonly (supprimer ts-jest, compiler via babel-jest + preset TS).

##### babel-jest 30.0.5

- Major align√©e avec Jest 30; n√©cessaire pour transformer d‚Äô√©ventuels fichiers JS/ESM et alternative de repli pour TS si on quitte ts-jest.

##### Ajv 8.17.1 + ajv-formats 3.0.1

- Derniers mineurs du major 8; ajv-formats v3 est la branche pr√©vue pour Ajv v8.
- Validation JSON Schema robuste, stricte et performante.

#### Justification pour Cadre de tests BDD et validation JSON

- jest-cucumber: BDD lisible (Gherkin) avec une ex√©cution unifi√©e via Jest.
- ts-jest: ex√©cution directe des steps TypeScript sans build pr√©alable.
- Ajv (+ formats): validation stricte et tra√ßable des artefacts JSON selon
  les sch√©mas partag√©s (contrat d‚Äôinterface).

#### Patterns valid√©s √† suivre pour Cadre de tests BDD et validation JSON

- Configuration centralis√©e: `cursor-ws-hermes2022-to-archimate/cucumber-jest.config.js`.
- D√©couverte des steps: `**/__tests__/{integration,e2e}/**/*.steps.{js,ts}` ;
  environnement `node` ; setup: `__tests__/support/jest-cucumber-setup.js`.
- R√©solution des artefacts: r√©pertoire pilot√© par `artifactBaseDir` dans
  `hermes2022-concepts-site-extraction/config/extraction-config.json` avec
  override optionnel par `HERMES2022_CONCEPTS_ARTIFACT_DIR`.
- Sidecar d‚Äôapprobation: fichier `*.approval.json` adjacent √† l‚Äôartefact.
- Sch√©mas de r√©f√©rence: `shared/hermes2022-extraction-files/config/json-schemas/*.json`.
- Outils √©diteur: configuration VSCode Cucumber (Gherkin) dans
  `cursor-ws-hermes2022-to-archimate/cucumber-vscode-plugin-settings.json`.

#### Anti-Patterns en raison d'erreurs identifi√©es, √† ne pas reproduire pour Cadre de tests BDD et validation JSON

- Runner Cucumber s√©par√©: √©viter la duplication d‚Äôinfrastructure de test ;
  privil√©gier Jest unique.
- Recherche multi-emplacements implicite pour les artefacts: √©viter des
  fallbacks opaques ; privil√©gier la configuration explicite du r√©pertoire.
- Couplage dur aux chemins: √©viter les chemins cod√©s en dur dans les steps ;
  utiliser config + variables d‚Äôenvironnement.

#### √âtat d'impl√©mentation de Cadre de tests BDD et validation JSON

‚úÖ Fonctionnel pour le module `hermes2022-concepts-site-extraction` (tests BDD
et validations JSON). Mont√©es de version √† effectuer de mani√®re coordonn√©e
(Jest/ts-jest) si n√©cessaire.

### Gestionnaire de paquets ‚Äî npm (interdiction de mixer avec yarn)

#### Description d√©taill√©e

- Gestionnaire retenu pour ce projet: npm.
- Contexte: d‚Äôautres projets imposent yarn (ex. int√©grations Flowable/React), mais ce d√©p√¥t utilise npm depuis l‚Äôorigine (installation des d√©pendances, ex√©cution des tests).

#### Justification

- Coh√©rence et tra√ßabilit√©: √©viter les d√©rives de lockfiles et r√©solutions diff√©rentes.
- Simplicit√©: outillage homog√®ne (`npm install`, `npx jest`, scripts npm).
- Isolation des projets: chaque d√©p√¥t fixe explicitement son gestionnaire.

#### Patterns valid√©s

- Installation: `npm install` exclusivement.
- Ex√©cution: `npx jest ‚Ä¶` ou via scripts npm (`npm run test` si d√©fini).
- Pas de lockfile yarn: pas de `yarn.lock` dans ce repo.

#### Anti-Patterns √† √©viter

- M√©lange npm/yarn dans le m√™me d√©p√¥t.
- Utilisation de `yarn` ou `pnpm` pour ce projet.

#### √âtat d‚Äôimpl√©mentation

‚úÖ npm utilis√© pour l‚Äôinstallation et l‚Äôex√©cution (`npx jest ‚Ä¶`); aucun artefact yarn attendu.

### Gestion des d√©pendances inter-modules : Chemins explicites relatifs √† repoRoot

#### Description d√©taill√©e

- [2025-10-20] Les d√©pendances vers les modules partag√©s (ex: `shared/hermes2022-extraction-files`) sont g√©r√©es via des chemins explicites relatifs √† la racine du repository dans les fichiers de configuration
- [2025-10-20] Alternative √©valu√©e : API JavaScript expos√©e par les modules partag√©s (rejet√©e pour complexit√© excessive)

#### Justification

- Simplicit√© de configuration (centralis√©e dans extraction-config.json)
- Ratio co√ªt/b√©n√©fice favorable pour notre contexte
- Pas de sur-engineering pour une flexibilit√© non n√©cessaire

#### Patterns valid√©s

- **CHEMINS COMPLETS** : Utiliser chemins complets depuis repoRoot (ex: `hermes2022-concepts-site-extraction/config/nuextract-api-key.key`)
- **R√âSOLUTION** : Utiliser `find-up` + `path.resolve()` comme d√©fini dans `@root-directory-governance.mdc`

#### Anti-Patterns √† √©viter

- **CHEMINS RELATIFS FRAGILES** : √âviter `../../../config/...` ‚Üí **Solution** : Chemins depuis repoRoot ‚Üí **R√®gle √† adopter** : Utiliser `find-up` pour d√©terminer repoRoot
- **CHEMINS RELATIFS AU MODULE** : √âviter `config/nuextract-api-key.key` m√™me dans le module ‚Üí **Solution** : Toujours depuis repoRoot ‚Üí **R√®gle √† adopter** : `hermes2022-concepts-site-extraction/config/...`

#### √âtat d'impl√©mentation

üöß [En cours d'impl√©mentation]
